# MaxLab Production Environment Configuration
# 이 파일을 production 서버에 복사하여 사용하세요

# 환경 설정 (중요!)
ENVIRONMENT=production

# 애플리케이션 도메인
APP_DOMAIN=maxlab.chem.co.kr
APP_URL=https://maxlab.chem.co.kr

# 데이터베이스 설정
DATABASE_URL=postgresql+asyncpg://postgres:2300@172.28.32.1:5432/max_lab

# SSL 설정 (production에서는 require 권장)
DB_SSL_MODE=disable  # 내부 네트워크인 경우 disable 가능

# 보안 키 (production용 - 반드시 변경하세요!)
SECRET_KEY=CHANGE_THIS_IN_PRODUCTION
JWT_SECRET_KEY=CHANGE_THIS_IN_PRODUCTION
CSRF_SECRET_KEY=CHANGE_THIS_IN_PRODUCTION
SESSION_SECRET_KEY=CHANGE_THIS_IN_PRODUCTION

# 암호화 키 (production용)
ENCRYPTION_KEY=CHANGE_THIS_IN_PRODUCTION

# 외부 인증 서버
AUTH_SERVER_URL=http://localhost:8000
AUTH_SERVER_TIMEOUT=10.0

# 서버 설정
HOST=127.0.0.1  # nginx 프록시 사용
PORT=8010

# CORS 설정 (production 도메인만 허용)
BACKEND_CORS_ORIGINS=https://maxlab.chem.co.kr,https://www.maxlab.chem.co.kr,https://app.maxlab.chem.co.kr
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=3600

# 로깅 설정 (production)
LOG_LEVEL=WARNING
LOG_FORMAT=json
LOG_FILE=/var/log/maxlab/backend-production.log

# Redis 설정 (production)
REDIS_URL=redis://localhost:6379/0

# WebSocket Configuration
ENABLE_WEBSOCKET=true
WEBSOCKET_TOKEN=prod-ws-token-change-this

# Rate Limiting (production에서는 엄격하게)
RATE_LIMITING_ENABLED=true
RATE_LIMITING_FAIL_OPEN=false
RATE_LIMITING_HEADERS_ENABLED=true

# Session Configuration (production)
SESSION_COOKIE_SECURE=true  # HTTPS 필수
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=strict
SESSION_LIFETIME_SECONDS=1800  # 30 minutes
SESSION_REMEMBER_ME_LIFETIME_SECONDS=604800  # 7 days
SESSION_MAX_PER_USER=5

# Security Headers
SECURE_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000  # 1 year

# Static/Media Files (nginx가 처리)
STATIC_FILES_DIR=/var/www/maxlab/static
MEDIA_FILES_PATH=/var/www/maxlab/media
SERVE_STATIC_FILES=False  # nginx가 처리

# Database Connection Pool
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_PRE_PING=true
DB_ECHO=false  # SQL 로깅 비활성화

# Performance (production)
WORKERS=4
WORKER_CLASS=uvicorn.workers.UvicornWorker
WORKER_CONNECTIONS=1000
WORKER_TIMEOUT=60
KEEPALIVE=5
GRACEFUL_TIMEOUT=30

# Monitoring
ENABLE_METRICS=true
METRICS_PORT=9090

# Scheduler
AUTO_CLOSE_DAYS_DEFAULT=90

# OAuth/OIDC Configuration
CLIENT_ID=maxlab

# Production Settings
DEBUG=False
ENABLE_DOCS=false  # API 문서 비활성화
ENABLE_REDOC=false
ENABLE_OPENAPI=false